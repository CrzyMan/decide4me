<!DOCTYPE html>

<html>
<head>
    <title>Decide 4 Me</title>
    <link rel="stylesheet" type="text/css" href="dfmStyle.css">
    <script src="Decide4Me.js"></script>
    <img src="delete_icon.png" hidden></img>
</head>

<body>
    <header>
        <h1>Decide For Me</h1>
    </header>
    
    <nav id="optionHolder">
        <div class="newOption"><input id="i_newOption" type="text" autofocus=true/><img class="delete" src="add.png" onclick="addNewOption()"/></div>
        
        <!-- this is the template and will not be displayed -->
        <div id="optionTemplate" class="optionDisplay" hidden=true>
            <span></span>
            <img class="delete" src="delete_icon.png" onclick="deleteOption(this.parentNode)"/>
        </div>
        <!-- -->
    </nav>
    
    <section>
        <div id="spinnerHolder"></div>
    </section>

<script>

// Make references to DOM elements
var optionTemplate = document.getElementById('optionTemplate');
var i_newOption = document.getElementById('i_newOption');
var optionHolder = document.getElementById('optionHolder');

// Start the Spinner handler
var dfm = new Decide4Me();
dfm.setHeight(700);
dfm.setRadius(340);

// Add the spinner to the holder
dfm.addTo(document.getElementById('spinnerHolder'));



/**
 * Adds a new option to the row of options, and also updates Decide4Me
 *
 * param name {String}  The name of the new option, defaults to the content of the new option input
 *
 * return {Boolean}  Whether or not the add was successful
 */
function addNewOption(name) {
    i_newOption.focus();
    
    // if no name is given, grab from the option input
    if (typeof name == "undefined") {
        name = i_newOption.value;
        i_newOption.value = "";
    }
    
    // if the name doesn't have letters or stuff
    if ("" == name.trim()) {
        return false;
    }
    
    // If we can even actually add it to the dfm
    if (dfm.addOption(name)) {
        // Make a new one
        var el = optionTemplate.cloneNode(true);
        
        // Set the name
        el.dataset.name = name;
        
        // Un-hide it
        el.hidden = false;
        
        // Update text in the span
        el.childNodes[1].innerHTML = name;
        
        // Set the color
        el.style.backgroundColor = dfm.getOption(name)[1];
        
        // Add element to the option holder
        optionHolder.appendChild(el);
        
        return true;
    }
    
    return false;
}



/**
 * Deletes an option's element and it's self from the spinner
 *
 * param option {Element}  The div element of the option
 */
function deleteOption(option) {
    // We can assume that this is called only by the delete buttons
    //   and that it will always be passed an option that is an element
    
    var name = option.dataset.name;
    
    // remove from dfm
    dfm.removeOption(name)
    
    // Remove from the option holder
    optionHolder.removeChild(option);
}


</script>

</body>
</html>